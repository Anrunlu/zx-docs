---
title: è£…è½½é—®é¢˜
icon: fas fa-calculator
author: å‘¨å­åŠ›
order: 20
category:
  - æ•™å­¦æ–‡æ¡£
tag:
  - å›æº¯ç®—æ³•
---


## é¢˜ç›®æè¿°

![picture 0](https://oss.docs.z-xin.net/31c294c9a58764ac7badd0aebc7e0cb4d89023387208a2e569edce5e753234a8.png)  


## è§£é¢˜æ€è·¯

## è§£é¢˜æ€è·¯

è¯¥ä»£ç ä½¿ç”¨**å¸¦ä¸Šç•Œå‰ªæçš„å®½åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰**æ¥æ±‚è§£å•èˆ¹è£…è½½é—®é¢˜ã€‚æ ¸å¿ƒæ€æƒ³å¦‚ä¸‹ï¼š

1. **é—®é¢˜å»ºæ¨¡**ï¼šå°†è£…è½½é—®é¢˜è§†ä¸º0-1èƒŒåŒ…é—®é¢˜ï¼Œæ¯ä¸ªé›†è£…ç®±æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼ˆè£…/ä¸è£…ï¼‰ï¼Œç›®æ ‡æ˜¯åœ¨ä¸è¶…è¿‡èˆ¹å®¹é‡çš„å‰æä¸‹ä½¿æ€»é‡é‡æœ€å¤§ã€‚

2. **BFSæœç´¢æ¡†æ¶**ï¼š
   - ä½¿ç”¨é˜Ÿåˆ—å­˜å‚¨çŠ¶æ€ `(level, current_weight)`ï¼Œå…¶ä¸­ `level` è¡¨ç¤ºå½“å‰å¤„ç†åˆ°ç¬¬å‡ ä¸ªé›†è£…ç®±ï¼ˆä»0å¼€å§‹ï¼‰ï¼Œ`current_weight` è¡¨ç¤ºå½“å‰å·²è£…è½½çš„æ€»é‡é‡ã€‚
   - ä»æ ¹èŠ‚ç‚¹ `(0, 0)` å¼€å§‹ï¼Œé€å±‚æ‰©å±•å†³ç­–æ ‘ã€‚

3. **ä¸Šç•Œå‰ªæä¼˜åŒ–**ï¼š
   - **é¢„å¤„ç†åç¼€å’Œæ•°ç»„ `bounds`**ï¼š`bounds[i]` è¡¨ç¤ºä»ç¬¬ `i` ä¸ªé›†è£…ç®±åˆ°æœ€åä¸€ä¸ªé›†è£…ç®±çš„æ€»é‡é‡ï¼ˆå³ `weights[i] + weights[i+1] + ... + weights[n-1]`ï¼‰ã€‚
   - **å‰ªææ¡ä»¶**ï¼šå¯¹äºå½“å‰çŠ¶æ€ `(level, current_weight)`ï¼Œè®¡ç®—å…¶ç†è®ºæœ€å¤§å¯èƒ½é‡é‡ `current_weight + bounds[level]`ï¼ˆå³å½“å‰é‡é‡åŠ ä¸Šå‰©ä½™æ‰€æœ‰é›†è£…ç®±é‡é‡ï¼‰ã€‚
   - **ä»…å½“ç†è®ºæœ€å¤§å€¼å¤§äºå½“å‰å·²çŸ¥æœ€ä¼˜è§£ `max_weight` æ—¶**ï¼Œæ‰å°†è¯¥åˆ†æ”¯åŠ å…¥é˜Ÿåˆ—ç»§ç»­æœç´¢ï¼Œå¦åˆ™å‰ªæã€‚

4. **æœç´¢è¿‡ç¨‹**ï¼š
   - å¯¹æ¯ä¸ªçŠ¶æ€ï¼Œå°è¯•è£…å…¥å½“å‰é›†è£…ç®±ï¼ˆè‹¥ä¸è¶…é‡ï¼‰å’Œä¸è£…å…¥ä¸¤ç§é€‰æ‹©ã€‚
   - åœ¨è£…å…¥æ“ä½œæ—¶æ›´æ–°å…¨å±€æœ€ä¼˜è§£ `max_weight`ã€‚
   - åˆ©ç”¨ä¸Šç•Œå‰ªæé¿å…æ¢ç´¢ä¸å¯èƒ½äº§ç”Ÿæ›´ä¼˜è§£çš„åˆ†æ”¯ã€‚

## ä»£ç å®ç°

### å®½åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰

```python
import queue
def fun(weights,capacity):
    max_weight=0
    n=len(weights)
    pq=queue.Queue()
    pq.put((0,0))

    while not pq.empty():
        level,current_weight=pq.get()
        if level==n:
            continue
        if current_weight+weights[level]<=capacity:
            temp_weight=current_weight+weights[level]
            max_weight=max(max_weight,temp_weight)
            pq.put((level+1,temp_weight))
        pq.put((level+1,current_weight))
               
    return max_weight

weights =[90,80,40,30,20,12,10]# [2, 3, 4, 5]  # Weights of the items
capacity = 152#8            # Capacity of the ship
# weights =[2, 3, 4, 5]  # Weights of the items
# capacity =8            # Capacity of the ship
result = fun(weights, capacity)
print("Maximum weight that can be loaded:", result)

```

---

### å¸¦ä¸Šç•Œå‰ªæçš„å®½åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰

```python

import queue
def fun2(weights,capacity):
    max_weight=0
    n=len(weights)
    pq=queue.Queue()
    pq.put((0,0))#first level,second,weight
    bounds=[0]*(n+1)
    for i in range(n-1,-1,-1):
        bounds[i]=bounds[i+1]+weights[i]
        print(i,bounds[i])
    while not pq.empty():
        level,current_weight=pq.get()
        
        if level==len(weights):
            continue
        if current_weight+weights[level]<=capacity:
            temp_weight=current_weight+weights[level]
            max_weight=max(max_weight,temp_weight)
            if temp_weight+bounds[level+1]>max_weight:
                pq.put((level+1,temp_weight))
        if current_weight+bounds[level+1]>max_weight:
            pq.put((level+1,current_weight))    
    
    return max_weight

weights =[90,80,40,30,20,12,10]# [2, 3, 4, 5]  # Weights of the items
capacity = 152#8            # Capacity of the ship
# weights =[2, 3, 4, 5]  # Weights of the items
# capacity =8            # Capacity of the ship
result = fun2(weights, capacity)
print("Maximum weight that can be loaded:", result)


```

---

### æœ€ä¼˜ä¼˜å…ˆæœç´¢

```python
import heapq

def fun(weights, capacity):
    n = len(weights)
    if n == 0 or capacity <= 0:
        return 0

    # é¢„å¤„ç†åç¼€å’Œï¼šbounds[i] = weights[i] + ... + weights[n-1]
    bounds = [0] * (n + 1)
    for i in range(n - 1, -1, -1):
        bounds[i] = bounds[i + 1] + weights[i]

    # æœ€å¤§å †ï¼šå­˜å‚¨ (-bound, level, current_weight)
    # ç”¨è´Ÿå€¼æ¨¡æ‹Ÿæœ€å¤§å †ï¼ˆå› ä¸º heapq æ˜¯æœ€å°å †ï¼‰
    max_heap = [(-bounds[0], 0, 0)]  # åˆå§‹ä¸Šç•Œæ˜¯æ‰€æœ‰ç‰©å“æ€»å’Œ
    max_weight = 0

    while max_heap:
        neg_bound, level, current_weight = heapq.heappop(max_heap)
        bound = -neg_bound

        # å‰ªæï¼šå¦‚æœä¸Šç•Œä¸è¶…è¿‡å½“å‰æœ€ä¼˜è§£ï¼Œè·³è¿‡
        if bound <= max_weight:
            continue

        # åˆ°è¾¾å¶èŠ‚ç‚¹
        if level == n:
            max_weight = max(max_weight, current_weight)
            continue

        w = weights[level]

        # é€‰æ‹©ï¼šè£…å…¥å½“å‰ç‰©å“ï¼ˆè‹¥ä¸è¶…è½½ï¼‰
        if current_weight + w <= capacity:
            new_weight = current_weight + w
            max_weight = max(max_weight, new_weight)  # åŠæ—¶æ›´æ–°æœ€ä¼˜è§£
            new_bound = new_weight + bounds[level + 1]
            if new_bound > max_weight:
                heapq.heappush(max_heap, (-new_bound, level + 1, new_weight))

        # ä¸é€‰æ‹©ï¼šä¸è£…å…¥å½“å‰ç‰©å“
        new_weight = current_weight
        new_bound = new_weight + bounds[level + 1]
        if new_bound > max_weight:
            heapq.heappush(max_heap, (-new_bound, level + 1, new_weight))

    return max_weight


# æµ‹è¯•
weights = [90, 80, 40, 30, 20, 12, 10]
capacity = 152
result = fun(weights, capacity)
print("Maximum weight that can be loaded:", result)

```



## ğŸš¨ æ³¨æ„äº‹é¡¹

### 1. **çŠ¶æ€è¡¨ç¤ºè¦æ¸…æ™°**
- åœ¨ BFS ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹åº”æ˜ç¡®è®°å½•ï¼šå½“å‰å¤„ç†åˆ°ç¬¬å‡ ä¸ªç‰©å“ã€å½“å‰æ€»é‡é‡ã€ä»¥åŠå¯é€‰åœ°è®°å½•æ‰€é€‰ç‰©å“åˆ—è¡¨ã€‚
- è‹¥åªè®°å½• `(level, weight)`ï¼Œè™½ç„¶èŠ‚çœç©ºé—´ï¼Œä½†æ— æ³•å›æº¯å…·ä½“æ–¹æ¡ˆï¼›è‹¥éœ€è¾“å‡ºæ–¹æ¡ˆï¼Œå¿…é¡»æºå¸¦é€‰æ‹©è·¯å¾„ã€‚

> âœ… å»ºè®®ï¼šæ ¹æ®éœ€æ±‚å†³å®šæ˜¯å¦å­˜å‚¨ `selected_items` åˆ—è¡¨ã€‚

---

### 2. **å‰ªææ¡ä»¶å¿…é¡»ä¸¥è°¨**
- ä¸Šç•Œå‰ªæï¼ˆå¦‚ `current_weight + bounds[level] > max_weight`ï¼‰æ˜¯æ€§èƒ½å…³é”®ï¼Œä½†å¿…é¡»ç¡®ä¿ï¼š
  - ä¸Šç•Œè®¡ç®—å‡†ç¡®ï¼ˆåç¼€å’Œ `bounds[i]` å¿…é¡»åŒ…å«ä» `i` å¼€å§‹çš„æ‰€æœ‰å‰©ä½™é‡é‡ï¼‰
  - å‰ªæåˆ¤æ–­é€»è¾‘ä¸èƒ½æ¼æ‰åˆæ³•æœ€ä¼˜è§£
  - é¿å…å› æµ®ç‚¹è¯¯å·®æˆ–æ•´æ•°æº¢å‡ºå¯¼è‡´é”™è¯¯å‰ªæï¼ˆæœ¬é¢˜ä¸ºæ•´æ•°ï¼Œæ— æ­¤é£é™©ï¼‰

> âš ï¸ ç‰¹åˆ«æ³¨æ„ï¼š**ä¸è¦åœ¨â€œè£…å…¥â€æ“ä½œå‰å‰ªæ**ï¼Œå› ä¸ºå³ä½¿å½“å‰é‡é‡+å‰©ä½™é‡é‡ > æœ€ä¼˜è§£ï¼Œä¹Ÿå¯èƒ½é€šè¿‡â€œä¸è£…å…¥â€æŸäº›å¤§ä»¶ç‰©å“æ¥è¾¾åˆ°æ›´ä¼˜è§£â€”â€”ä½†åœ¨æœ¬ç®—æ³•ä¸­ï¼Œç”±äºæˆ‘ä»¬æ˜¯ä»å·¦åˆ°å³é¡ºåºå†³ç­–ï¼Œä¸”ä¸Šç•Œæ˜¯â€œå‰©ä½™æ‰€æœ‰â€ï¼Œå› æ­¤è¯¥å‰ªææ˜¯å®‰å…¨çš„ã€‚

---

### 3. **è¾¹ç•Œæƒ…å†µå¤„ç†**
- ç©ºç‰©å“åˆ—è¡¨ â†’ è¿”å› 0
- æ‰€æœ‰ç‰©å“éƒ½è¶…é‡ â†’ è¿”å› 0
- å®¹é‡ä¸º 0 â†’ è¿”å› 0
- å•ä¸ªç‰©å“åˆšå¥½ç­‰äºå®¹é‡ â†’ åº”èƒ½æ­£ç¡®è¯†åˆ«

> âœ… æµ‹è¯•ç”¨ä¾‹å»ºè®®è¦†ç›–ä»¥ä¸Šæç«¯æƒ…å†µã€‚

---

### 4. **é˜Ÿåˆ—å®ç°ä¸æ€§èƒ½**
- Python çš„ `queue.Queue()` æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†æ•ˆç‡ç•¥ä½äº `collections.deque`ã€‚
- å¯¹äºçº¯ç®—æ³•é¢˜ï¼Œæ¨èä½¿ç”¨ `from collections import deque`ï¼Œå…¶ `popleft()` å’Œ `append()` æ“ä½œæ—¶é—´å¤æ‚åº¦ä¸º O(1)ã€‚

> âœ… æ”¹è¿›å»ºè®®ï¼š
```python
from collections import deque
q = deque()
q.append((0, 0))
...
level, weight = q.popleft()
```

---

### 5. **å¶èŠ‚ç‚¹æ›´æ–°ç¼ºå¤±é—®é¢˜**
- å¦‚ä¹‹å‰åˆ†æï¼Œåœ¨ `level == n` æ—¶ç›´æ¥ `continue`ï¼Œå¯èƒ½é—æ¼æœªè¢«â€œè£…å…¥â€åŠ¨ä½œæ›´æ–°çš„åˆæ³•è§£ï¼ˆå°½ç®¡åœ¨å®è·µä¸­ä¸ä¼šå‘ç”Ÿï¼Œå› ä¸ºæ‰€æœ‰éé›¶é‡é‡éƒ½æ¥è‡ªâ€œè£…å…¥â€æ“ä½œï¼‰ã€‚
- **å¥å£®æ€§å»ºè®®**ï¼šæ˜¾å¼å¤„ç†å¶èŠ‚ç‚¹ï¼š
```python
if level == n:
    max_weight = max(max_weight, current_weight)
    continue
```

---

### 6. **å˜é‡å‘½åä¸ä»£ç å¯è¯»æ€§**
- `pq` æ˜“è¢«è¯¯è§£ä¸ºâ€œä¼˜å…ˆé˜Ÿåˆ—â€ï¼Œå®é™…æ˜¯æ™®é€š FIFO é˜Ÿåˆ— â†’ å»ºè®®æ”¹åä¸º `bfs_queue` æˆ– `q`
- `bounds` å¯è€ƒè™‘å‘½åä¸º `suffix_sum` æˆ– `remaining_weight` ä»¥å¢å¼ºè¯­ä¹‰

> âœ… å¥½çš„å‘½å = è‡ªæ–‡æ¡£åŒ–ä»£ç 

---

### 7. **å†…å­˜çˆ†ç‚¸é£é™©**
- BFS åœ¨æœ€åæƒ…å†µä¸‹ä¼šç”Ÿæˆ 2^n ä¸ªçŠ¶æ€ï¼Œå½“ n > 20 æ—¶å†…å­˜å’Œæ—¶é—´å¼€é”€å‰§å¢ã€‚
- å®é™…åº”ç”¨ä¸­ï¼Œn è¾ƒå¤§æ—¶åº”æ”¹ç”¨åŠ¨æ€è§„åˆ’æˆ–åˆ†æ”¯é™ç•Œæ³•ã€‚

> ğŸ’¡ æç¤ºï¼šå¯¹äº `n=30`ï¼Œ2^30 â‰ˆ 10äº¿çŠ¶æ€ï¼Œä¸å¯è¡Œï¼

---

## ğŸ’¡ å¯å‘ä¸å»¶ä¼¸æ€è€ƒ

### 1. **ç®—æ³•æ€æƒ³è¿ç§»**
- è£…è½½é—®é¢˜æœ¬è´¨æ˜¯ **0-1 èƒŒåŒ…é—®é¢˜**ï¼ŒBFS + å‰ªææ˜¯ä¸€ç§â€œæš´åŠ›ä¼˜åŒ–â€æ€è·¯ã€‚
- ç±»ä¼¼æ–¹æ³•å¯ç”¨äºï¼š
  - å­é›†å’Œé—®é¢˜ï¼ˆSubset Sumï¼‰
  - æœ€å¤§ç‹¬ç«‹é›†ï¼ˆå›¾è®ºï¼‰
  - TSPï¼ˆæ—…è¡Œå•†é—®é¢˜ï¼‰çš„éƒ¨åˆ†è§£ç©ºé—´æœç´¢

> âœ… å¯å‘ï¼šä»»ä½•å…·æœ‰â€œå†³ç­–æ ‘ç»“æ„â€çš„ç»„åˆä¼˜åŒ–é—®é¢˜ï¼Œéƒ½å¯ä»¥å°è¯• BFS + å‰ªæã€‚

---

### 2. **å‰ªæç­–ç•¥çš„é€šç”¨æ€§**
- â€œä¸Šç•Œå‰ªæâ€ï¼ˆUpper Bound Pruningï¼‰æ˜¯åˆ†æ”¯é™ç•Œæ³•çš„æ ¸å¿ƒæ€æƒ³ã€‚
- å¯æ‰©å±•ä¸ºï¼š
  - **ä¸‹ç•Œå‰ªæ**ï¼ˆLower Bound Pruningï¼‰ï¼šç”¨äºæœ€å°åŒ–é—®é¢˜
  - **å¯è¡Œæ€§å‰ªæ**ï¼šæå‰æ’é™¤ä¸å¯èƒ½æ»¡è¶³çº¦æŸçš„åˆ†æ”¯
  - **æ”¯é…å‰ªæ**ï¼šè‹¥ä¸€ä¸ªçŠ¶æ€è¢«å¦ä¸€ä¸ªçŠ¶æ€â€œæ”¯é…â€ï¼ˆæ›´ä¼˜ï¼‰ï¼Œåˆ™å‰ªæ‰

> âœ… å¯å‘ï¼šå‰ªæä¸æ˜¯é­”æ³•ï¼Œè€Œæ˜¯å¯¹é—®é¢˜ç»“æ„çš„æ·±åˆ»ç†è§£ã€‚

---

### 3. **åŠ¨æ€è§„åˆ’ vs BFS å‰ªæ**
- **DP ä¼˜åŠ¿**ï¼šæ—¶é—´å¤æ‚åº¦ O(n Ã— capacity)ï¼Œé€‚åˆå®¹é‡è¾ƒå°çš„æƒ…å†µ
- **BFS å‰ªæä¼˜åŠ¿**ï¼šå¯è¾“å‡ºå…·ä½“æ–¹æ¡ˆã€æ˜“äºå¹¶è¡ŒåŒ–ã€é€‚ç”¨äºå®¹é‡æå¤§æˆ–éæ•°å€¼çº¦æŸçš„é—®é¢˜

> âœ… å¯å‘ï¼šæ²¡æœ‰â€œæœ€å¥½â€çš„ç®—æ³•ï¼Œåªæœ‰â€œæœ€é€‚åˆâ€çš„ç®—æ³•ã€‚æ ¹æ®æ•°æ®è§„æ¨¡å’Œéœ€æ±‚é€‰æ‹©ã€‚

---

### 4. **å¯å‘å¼æœç´¢çš„æ¡¥æ¢**
- BFS + ä¸Šç•Œå‰ªæ æ˜¯å‘ **A* æœç´¢** æˆ– **åˆ†æ”¯é™ç•Œæ³•** è¿ˆè¿›çš„ç¬¬ä¸€æ­¥ã€‚
- è‹¥å°†â€œå½“å‰é‡é‡ + å‰©ä½™æœ€å¤§å¯èƒ½é‡é‡â€ä½œä¸ºå¯å‘å‡½æ•°ï¼Œå³å¯æ„å»º A* æœç´¢æ¡†æ¶ã€‚

> âœ… å¯å‘ï¼šæŒæ¡åŸºç¡€ç®—æ³•ï¼Œæ˜¯é€šå‘é«˜çº§ç®—æ³•çš„é˜¶æ¢¯ã€‚

---

### 5. **å·¥ç¨‹å®è·µä¸­çš„æƒè¡¡**
- åœ¨ç«èµ›æˆ–é¢è¯•ä¸­ï¼ŒBFS + å‰ªæå¸¸ç”¨äºå°è§„æ¨¡æ•°æ®ï¼ˆn â‰¤ 20ï¼‰ã€‚
- åœ¨å·¥ä¸šçº§ç³»ç»Ÿä¸­ï¼Œåº”ä¼˜å…ˆè€ƒè™‘ DPã€è´ªå¿ƒã€è¿‘ä¼¼ç®—æ³•æˆ–æ··åˆæ–¹æ³•ã€‚

> âœ… å¯å‘ï¼šç®—æ³•é€‰æ‹©è¦è€ƒè™‘â€œç²¾åº¦ã€é€Ÿåº¦ã€å†…å­˜ã€å¯ç»´æŠ¤æ€§â€å››ç»´å¹³è¡¡ã€‚

---

## ğŸ¯ æ€»ç»“ä¸€å¥è¯ï¼š

> **BFS è§£è£…è½½é—®é¢˜æ˜¯â€œæš´åŠ›ç¾å­¦â€çš„ä½“ç° â€”â€” ç”¨ç©ºé—´æ¢æ—¶é—´ï¼Œç”¨å‰ªæé™å¤æ‚åº¦ï¼Œç”¨ç»“æ„åŒ–æ€ç»´é©¾é©­æŒ‡æ•°çˆ†ç‚¸çš„è§£ç©ºé—´ã€‚**

æŒæ¡å®ƒï¼Œä¸ä»…è§£å†³ä¸€é“é¢˜ï¼Œæ›´æ˜¯æ‰“å¼€ç»„åˆä¼˜åŒ–ä¸–ç•Œçš„å¤§é—¨ã€‚
